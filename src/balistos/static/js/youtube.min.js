

$(document).click(function(){$('#response').hide();});$(document).on("click","#response",function(event){event.stopPropagation();});function showResponse(response){$("#response").html("");$.each(response.items,function(index,value){$("#response").append("<li data-title='"+value.snippet.title+"' data-image='"+value.snippet.thumbnails.default.url+"' title='Add "+value.snippet.title+" to playlist' data-bind='click: addVideo' data-id='"+value.id.videoId+"' id='video-"+value.id.videoId+"'><img src='"+value.snippet.thumbnails.default.url+"'><div class='title'>"+value.snippet.title+"</div></li>");ko.applyBindings(playlist,$("#video-"+value.id.videoId)[0]);});$("#response").show();}
function onClientLoad(){gapi.client.load('youtube','v3',onYouTubeApiLoad);}
function onYouTubeApiLoad(){gapi.client.setApiKey('AIzaSyCnR3Vv-Erxjaa-IJapIXCnvgTOuXLXItA');}
function search(query){var request=gapi.client.youtube.search.list({part:'snippet',q:query,type:'video',maxResults:8,format:5,key:'AIzaSyCnR3Vv-Erxjaa-IJapIXCnvgTOuXLXItA'});request.execute(showResponse);}
var tag=document.createElement('script');tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName('script')[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);var player;function onYouTubeIframeAPIReady(){$("#search").keyup(function(e){ if($(this).val()===""){$("#response").hide();}
else{ var code=(e.keyCode?e.keyCode:e.which);var idx;if(code==40){if($("#response").children("li.active").length<1){$("#response").children("li:first-child").addClass("active");}
else{idx=$("#response").children("li.active").index()+1;$("#response").children().removeClass("active");if(idx>7)
idx=0;$("#response").children().eq(idx).addClass("active");}}
else if(code==38){if($("#response").children("li.active").length<1){$("#response").children().eq(7).addClass("active");}
else{idx=$("#response").children("li.active").index()-1;$("#response").children().removeClass("active");if(idx<0)
idx=7;$("#response").children().eq(idx).addClass("active");}}
else if(code==13){if($("#response").children("li.active").length>0){$("#response").children("li.active").trigger("click");}}
else{delaySearch($(this).val());}}});$(document).on("click",".overlay.play",function(){player.playVideo();$(".overlay").removeClass("play").addClass("pause");});$(document).on("click",".overlay.pause",function(){player.pauseVideo();$(".overlay").removeClass("pause").addClass("play");});$(document).on("click",".overlay.mute",function(){player.mute();$(".overlay").removeClass("mute").addClass("unmute");});$(document).on("click",".overlay.unmute",function(){player.unMute();$(".overlay").removeClass("unmute").addClass("mute");});$("#video-id").bind("DOMSubtreeModified",function(){if($(this).text()!==""){if(player){player.loadVideoById($(this).text(),0,"large");}
else{initPlayer();}}});initPlayer();}
function initPlayer(){var video=$("#video-id").text();var start=parseInt($("#video-start").text());if(video!==""){player=new YT.Player("player",{height:"390",width:"640",videoId:video,playerVars:{controls:0,showinfo:0,start:start,disablekb:1,wmode:"transparent",},events:{"onReady":onPlayerReady}});}
else{$("#player").text("No video currently in the queue.");}}
function onPlayerReady(event){event.target.playVideo();}
var typingTimer;var doneTypingInterval=300;function delaySearch(query){clearTimeout(typingTimer);typingTimer=setTimeout(function(){search(query);},doneTypingInterval);return true;}