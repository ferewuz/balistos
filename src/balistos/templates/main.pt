<metal:block metal:use-macro="main_template">
    <div metal:fill-slot="content" id="content">
        <div class="row">
            <div class="col-lg-8">
                <div class="search">
                    <div class="message" id="hidden-search" tal:attributes="style python: 'display:none' if username else ''">To search and add videos to the queue, please login.</div>
                    <input type="text" class="form-control" id="search" placeholder="Search video" autocomplete="off" tal:attributes="style python: 'display:none' if not username else ''" />
                    <ul class="dropdown-menu autocomplete" id="response"></ul>
                </div>
            </div>
            <div class="col-lg-8">
                <div class="video-player">
                    <div class="title">Now playing: <span data-bind="text: firstVideoTitle"></span></div>
                    <div class="video-id" data-bind="text: firstVideoId" id="video-id"></div>
                    <div class="video-id" data-bind="text: firstVideoStart" id="video-start"></div>
                    <div data-bind="click: removeFirstVideo" class="close-button"></div>
                    <div class="player">
                        <div class="overlay mute"></div>
                        <div id="player"></div>
                        <div class="progress">
                            <div class="progress-bar" role="progressbar"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-12 col-sm-12">
                <div class="col-lg-12 col-md-4 col-sm-6 col-xs-12  playlist" >
                    <div class="playlist-title">Playlist</div>
                    <div data-bind="foreach: videos">
                        <div data-bind="if: $index()>0">
                            <div class="video-box" data-bind="css: {'second': $index()==1}">
                                <img data-bind="attr: { src: image }" />
                                <div class="video-right">
                                    <div data-bind="text: title" class="title"></div>
                                    <div class="arrows logged-in" tal:attributes="style python: 'display:none' if not username else ''">
                                        <div data-bind="click: addLike, css: { 'active': liked()>0 }" class="arrow-up"></div>
                                        <div data-bind="click: removeLike , css: { 'active': liked()<0 }" class="arrow-down"></div>
                                    </div>
                                    <div data-bind="text: likes" class="likes"></div>
                                    <div class="added-by">
                                        added by  
                                        <span data-bind="text: owner"></span>
                                    </div>
                                    <span class="close-button" data-bind="click: removeVideo" ></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12 col-md-4 col-sm-6 col-xs-12 playlist pull-right" >
                    <div class="sidebox">
                        <div class="header" >
                            <span class="badge pull-right" data-bind="text: getUsersTotal()"></span>
                            Active users
                        </div>
                        <ul data-bind="foreach: users" class="content">
                            <li class="user">
                                <div class="username" data-bind="text: username"></div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-12 col-md-4 col-sm-6 col-xs-12 playlist pull-right" >
                    <div class="sidebox">
                        <div class="header">Chat</div>
                        <div class="chat-container" id="chat-div">
                            <ul data-bind="foreach: messages" class="chat" >
                                <li class="line">
                                    [<span class="type" data-bind="text: time"></span>] 
                                    <span class="username" style="font-weight:700;" data-bind="text: author"></span>:
                                    <span class="username" data-bind="text: message"></span>
                                </li>
                            </ul>
                        </div>
                        <form id="chat-form" class="form-inline logged-in" role="form" style="padding:10px 20px;" tal:attributes="style python: 'display:none' if not username else ''">
                            <div class="input-group">
                                <input name="message" type="text" class="form-control" />
                                <span class="input-group-btn">
                                    <button class="btn btn-info send-icon" type="submit"></button>
                                </span>
                            </div>
                        </form>
                    </div>
                </div> 
            </div>
        </div>
        <script src="https://apis.google.com/js/client.js?onload=onClientLoad" type="text/javascript"></script>
    </div>
</metal:block>
